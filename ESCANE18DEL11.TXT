El escaneo de seguridad realizado con OWASP ZAP sobre la plataforma Restaurante-SaaS evidenció únicamente hallazgos de riesgo bajo y ningún hallazgo de riesgo medio o alto directamente atribuible a los servicios desarrollados. Esto confirma que las medidas de seguridad aplicadas (uso de Helmet, CORS con allowlist, protección CSRF y rate limiting, entre otras) proporcionan una superficie de exposición razonablemente controlada para el contexto del proyecto.

En primer lugar, se identificó la presencia de una cookie csrf_token sin la bandera HttpOnly en los servicios de pedidos y facturación. Este comportamiento es intencional, ya que dicha cookie no almacena credenciales ni sesiones, sino un token aleatorio utilizado en un esquema de protección CSRF de tipo double-submit (cookie + cabecera x-csrf-token). Como medida de endurecimiento se restringió el ámbito de la cookie mediante SameSite=Lax, uso de Secure en entornos de producción, limitación de la ruta a /api y definición de un tiempo de vida máximo de 12 horas. En consecuencia, el riesgo residual se considera bajo y explícitamente aceptado, quedando debidamente documentado como excepción controlada.

En cuanto a las cabeceras de seguridad, los tres backends (backend-pedidos, backend-facturacion y backend-pasarela) añaden de forma sistemática X-Content-Type-Options: nosniff, políticas anti-clickjacking (X-Frame-Options/frameguard) y políticas de Content Security Policy (CSP) restrictivas a través de Helmet, así como la eliminación de X-Powered-By y, en el caso de facturación, la activación de HSTS en producción. El aviso de ZAP respecto a la ausencia de X-Content-Type-Options se limita al servidor de desarrollo de Vite del frontend administrador (http://localhost:5173), que no representa el entorno final. Para producción se ha definido que el frontend sea servido detrás de un reverse proxy (por ejemplo Nginx), el cual añadirá centralmente las cabeceras X-Content-Type-Options, X-Frame-Options, Referrer-Policy y una CSP adecuada, cerrando así este punto en el despliegue real.

Otro hallazgo de bajo riesgo corresponde a la “inclusión de archivos fuente JavaScript entre dominios” en el frontend KDS (http://localhost:5174), derivado principalmente del uso de Google Fonts y del cliente de desarrollo de Vite. Dado que se trata de dependencias de terceros de confianza y que este patrón solo se utiliza en entorno de desarrollo, se opta por aceptar el riesgo en dicho contexto. Como medida de mitigación planificada para producción, se servirá el bundle JavaScript, las hojas de estilo y las fuentes desde el propio dominio de la aplicación (a partir del build del frontend) y se aplicará una política CSP que limite los orígenes a self y a las pasarelas de pago estrictamente necesarias (Mercado Pago y Culqi), reduciendo significativamente la superficie de ataque asociada a recursos externos.

Finalmente, algunas alertas reportadas por OWASP ZAP se asocian a dominios externos ajenos a la aplicación, como https://firefox-settings-attachments.cdn.mozilla.net, correspondientes a tráfico generado automáticamente por el navegador (Firefox). Estos hallazgos se consideran explícitamente fuera del alcance de la plataforma Restaurante-SaaS y no requieren acciones de mitigación por parte del equipo de desarrollo.

En conjunto, tras aplicar los ajustes descritos y documentar los riesgos residuales aceptados, se concluye que el nivel de exposición identificado por OWASP ZAP es bajo y coherente con el nivel de madurez esperado para el proyecto, quedando además trazado un plan claro para reforzar las cabeceras de seguridad y el uso de recursos externos en el entorno de producción.

ZAP identificó la cookie csrf_token como posible indicio de gestión de sesión. Se verificó que dicha cookie no se usa para autenticación, sino exclusivamente como token CSRF en un esquema de double-submit. La cookie está protegida mediante SameSite=Lax, Secure en producción, Path restringido a /api y expiración limitada, por lo que se considera una alerta informativa sin impacto de seguridad relevante.3

La alerta “Aplicación Web Moderna” indica que el frontend utiliza tecnologías modernas (SPA / JavaScript modular). No representa una vulnerabilidad, sino una recomendación de metodología de escaneo. No requiere cambios en la aplicación, únicamente se tiene en cuenta para futuras ejecuciones de ZAP (usar Ajax Spider).

ZAP detectó un parámetro token en la URL (http://localhost:5173/?token=...) y lo marcó como posible divulgación de información sensible. Se ajustó el frontend para leer dicho valor una sola vez al inicio, procesarlo según la lógica de negocio y eliminarlo de la barra de direcciones mediante window.history.replaceState, evitando su persistencia en el historial y en logs. Además, el backend garantizará que cualquier token usado en URL sea de un solo uso y con expiración, por lo que el riesgo se considera mitigado.

Las alertas informativas “Recuperado de la Caché” y “Reexaminar las Directivas de Control de Caché” corresponden al dominio firefox.settings.services.mozilla.com, generado automáticamente por el navegador Firefox. Estas peticiones no forman parte de la aplicación Restaurante-SaaS y no pueden ser controladas ni modificadas por el equipo de desarrollo, por lo que se consideran fuera de alcance.